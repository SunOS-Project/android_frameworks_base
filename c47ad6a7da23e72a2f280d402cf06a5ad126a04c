{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "d8e99efc_048d7ff4",
        "filename": "services/core/java/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.java",
        "patchSetId": 2
      },
      "lineNbr": 99,
      "author": {
        "id": 4550
      },
      "writtenOn": "2025-02-11T12:42:01Z",
      "side": 1,
      "message": "You likely need to add some logic here to take the new filename into account and not break HIDL",
      "range": {
        "startLine": 97,
        "startChar": 8,
        "endLine": 99,
        "endChar": 62
      },
      "revId": "c47ad6a7da23e72a2f280d402cf06a5ad126a04c",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "35b6ebb3_0a06d85e",
        "filename": "services/core/java/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.java",
        "patchSetId": 2
      },
      "lineNbr": 99,
      "author": {
        "id": 31578
      },
      "writtenOn": "2025-02-11T12:55:21Z",
      "side": 1,
      "message": "doesn\u0027t HIDL use the legacy file name \"settings_fingerprint.xml\"?",
      "parentUuid": "d8e99efc_048d7ff4",
      "range": {
        "startLine": 97,
        "startChar": 8,
        "endLine": 99,
        "endChar": 62
      },
      "revId": "c47ad6a7da23e72a2f280d402cf06a5ad126a04c",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "161fbf60_5eba3c03",
        "filename": "services/core/java/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.java",
        "patchSetId": 2
      },
      "lineNbr": 99,
      "author": {
        "id": 4550
      },
      "writtenOn": "2025-02-11T13:02:11Z",
      "side": 1,
      "message": "Yes but you move it below so now it will be missing. Or does HIDL not use the newly added code?",
      "parentUuid": "35b6ebb3_0a06d85e",
      "range": {
        "startLine": 97,
        "startChar": 8,
        "endLine": 99,
        "endChar": 62
      },
      "revId": "c47ad6a7da23e72a2f280d402cf06a5ad126a04c",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4200d78d_9aff2d81",
        "filename": "services/core/java/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.java",
        "patchSetId": 2
      },
      "lineNbr": 99,
      "author": {
        "id": 31578
      },
      "writtenOn": "2025-02-11T13:04:06Z",
      "side": 1,
      "message": "it checks the file name and only does the move if the filename matches regex \"settings_fingerprint_\\\\d+.xml\". If it is HIDL, then the filename is \"settings_fingerprint.xml\", so the detection returns false, and the move will not happen.",
      "parentUuid": "161fbf60_5eba3c03",
      "range": {
        "startLine": 97,
        "startChar": 8,
        "endLine": 99,
        "endChar": 62
      },
      "revId": "c47ad6a7da23e72a2f280d402cf06a5ad126a04c",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "07d1974a_47c79da7",
        "filename": "services/core/java/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.java",
        "patchSetId": 2
      },
      "lineNbr": 99,
      "author": {
        "id": 4550
      },
      "writtenOn": "2025-02-11T13:08:10Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "4200d78d_9aff2d81",
      "range": {
        "startLine": 97,
        "startChar": 8,
        "endLine": 99,
        "endChar": 62
      },
      "revId": "c47ad6a7da23e72a2f280d402cf06a5ad126a04c",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e9475737_fba82986",
        "filename": "services/core/java/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.java",
        "patchSetId": 2
      },
      "lineNbr": 182,
      "author": {
        "id": 11883
      },
      "writtenOn": "2025-02-11T15:50:28Z",
      "side": 1,
      "message": "why this fallback?\nI know it\u0027s probably safe but I think failing the migration (aka rename) shouldn\u0027t do that?",
      "revId": "c47ad6a7da23e72a2f280d402cf06a5ad126a04c",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d203cef7_d773dbd0",
        "filename": "services/core/java/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.java",
        "patchSetId": 2
      },
      "lineNbr": 182,
      "author": {
        "id": 31578
      },
      "writtenOn": "2025-02-11T16:33:55Z",
      "side": 1,
      "message": "because reading the old file still works, and makes the fp work. Do you have any other suggestions?",
      "parentUuid": "e9475737_fba82986",
      "revId": "c47ad6a7da23e72a2f280d402cf06a5ad126a04c",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1f791e59_e929f106",
        "filename": "services/core/java/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.java",
        "patchSetId": 2
      },
      "lineNbr": 182,
      "author": {
        "id": 11883
      },
      "writtenOn": "2025-02-11T16:39:21Z",
      "side": 1,
      "message": "You\u0027re trying to migrate the file by renaming it, but also do no migration at all and use the old file in case that fails (can it?)\nI\u0027d expect the code to only do one of those, rename OR use old file.\n\nI\u0027d be more aggressive and make rename/deletion hard failures so that we know the migration didn\u0027t work.",
      "parentUuid": "d203cef7_d773dbd0",
      "revId": "c47ad6a7da23e72a2f280d402cf06a5ad126a04c",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9978b2e7_207622cf",
        "filename": "services/core/java/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.java",
        "patchSetId": 2
      },
      "lineNbr": 182,
      "author": {
        "id": 31578
      },
      "writtenOn": "2025-02-11T16:45:43Z",
      "side": 1,
      "message": "so make it throw an exception here?",
      "parentUuid": "1f791e59_e929f106",
      "revId": "c47ad6a7da23e72a2f280d402cf06a5ad126a04c",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "aa424752_d7ac4061",
        "filename": "services/core/java/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.java",
        "patchSetId": 2
      },
      "lineNbr": 182,
      "author": {
        "id": 11883
      },
      "writtenOn": "2025-02-11T16:54:01Z",
      "side": 1,
      "message": "I expect the delete/rename to always work, if that\u0027s the case no failure is expected and you should throw yes.",
      "parentUuid": "9978b2e7_207622cf",
      "revId": "c47ad6a7da23e72a2f280d402cf06a5ad126a04c",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ea7f0c65_a6e663a0",
        "filename": "services/core/java/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.java",
        "patchSetId": 2
      },
      "lineNbr": 182,
      "author": {
        "id": 4550
      },
      "writtenOn": "2025-02-11T17:32:40Z",
      "side": 1,
      "message": "Keep in mind that if you fail hard, there\u0027s a chance that you will lose existing fingerprints, which we don\u0027t want",
      "parentUuid": "aa424752_d7ac4061",
      "revId": "c47ad6a7da23e72a2f280d402cf06a5ad126a04c",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "eb02c69f_f7156c37",
        "filename": "services/core/java/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.java",
        "patchSetId": 2
      },
      "lineNbr": 182,
      "author": {
        "id": 11883
      },
      "writtenOn": "2025-02-11T17:37:06Z",
      "side": 1,
      "message": "That\u0027ll work as long as we keep this patch around, ensuring file copy _always_ works avoids that.\nIf we can\u0027t assure the file copy will work that\u0027s fine, but if we know it\u0027ll work I\u0027d prefer that?\nI\u0027m not going to block this change for that, but I think it would be better if we can do that ðŸ˜Š",
      "parentUuid": "ea7f0c65_a6e663a0",
      "revId": "c47ad6a7da23e72a2f280d402cf06a5ad126a04c",
      "serverId": "1ec6b3db-b2c1-4fa4-84a2-4c7efe89ba71"
    }
  ]
}